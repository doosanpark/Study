# 1장. 사용자 수에 따른 규모 확장성

# 단일 서버

웹, 앱. 데이터베이스, 캐시가 서버 한대에서 실행

# 수직적 규모 확장 VS 수평적 규모 확장

**수직적 규모 확장**: 스케일 업(scale up)

서버에 고사양 자원을 추가하는 행위

**수평적 규모 확장**: 스케일 아웃(scale out)

더 많은 서버를 추가하여 성능 개선

## 로드밸런서(Load Banlancer)

- 부하 분산 집합(load balancing set)에 속한 웹 서버들에게 **트래픽 부하를 고르게 분산**하는 역할
- 사용자는 **로드밸런서의 공개 IP 주소**(public IP address)로 접속하기에 웹서버에 직접 접근하지 않음
- 서버간 통신에는 **사설IP 주소** 이용
- 서버 1이 다운되면 모든 트래픽은 서버 2로 전송

## 데이터베이스 다중화

- 보통 서버 사이에 주(master) - 부(slave) 관계 설정하며, 원본은 주 서버에, 사본은 부 서버에 저장
- 데이터베이스 병렬 처리로 인해 성능 향상
- 일부 데이터베이스 서버 누락 또는 장애 상황에도 다중화로 인한 데이터 보존 가능

**주(master)** : 데이터 원본, 쓰기 연산, 소수 존재

**부(slave)**: 데이터 사본, 읽기 연산, 다수 존재

# 캐시

부하가 큰 데이터를 메모리 안에 둬서 보다 빨리 처리될 수 있도록 하는 저장소

애플리케이션의 성능은 데이터베이스를 얼마나 자주 호출하느냐에 따라 크게 좌우되는데, 캐시는 그런 문제 완화

## 캐시 계층

1. 캐시 저장되어있는지  확인

2.1 캐시에 저장 안돼있으면 DB에서 데이터를 읽어 캐시에 씀

2.2 캐시에 저장 돼있으면 바로 웹 서버에 데이터 반환

## 유의점

- 갱신은 자주 안일어나지만 참조는 많이 일어날 때
- 언제 만료되는지 체크
- 일관성 체크
- 장애 대응
- 메모리 할당은 과할당으로
- 데이터 방출은 LRU(Least Recently Used), LFU(Least Frequently Used), FIFO 등